<div id="scope-panel" class="right panel" <% if cookies['scope-panel.width'] %>style="width: <%=cookies['scope-panel.width']%>px"<% end %>>
	<div class="back">
		<div class="shadow"></div>
	</div>
	<a href="#" class="ui-resizable-handle ui-resizable-w toggle"></a>
	<div class="cont">
		
		<div id="pile-list">
			<h1 class="header">Piles</h1>
			
			<div class="pile name">
				<span class="sym"><%# ∴ %>&there4;</span>
				<%= link_to h(@owner.login), [@owner, @owner.root_pile] %>
			</div>
			
			<ul>
				<%= render :partial => 'list_piles', :locals => { :pile => @owner.root_pile, :expand_to => lambda {|p| p == @pile || @pile.ancestors.include?(p) } } %>
			</ul>
		</div>
		
	</div>
</div>

<div id="main-area" class="left" <% if cookies['scope-panel.width'] %>style="margin-right: <%=cookies['scope-panel.width']%>px"<% end %>><% @skip_main_area_wrap = true %>
	<div class="cont">
		
		<% content_tag_for :div, @pile.root_node, :class => "base root item" do -%>
			<%- cache ({:base_node_section => @pile.root_node.id}.to_json) do -%>
				<section class="base pile cont" oc:nodes-url="<%=path_for([@owner, @pile, :nodes])%>">
					
					<div class="body">
						<div class="back"></div>
						
						<%= render :partial => 'nodes/action_stub' %>
						
						<h1 class="header" onclick="void(0)"><%# onclick, for MobileSafari, with Love -%>
							<span class="owner">
								<%= @owner.name %>
								<% unless @pile.root? %><%# » %>&raquo;</span> <span class="name"><%= @pile.name %><% end %>
							</span>
						</h1>
					</div>
					
					<ul class="item-list">
						<%= render :partial => 'nodes/list_items', :locals => {:item => @pile.root_node} -%>
					</ul>
					
					<%= render :partial => 'nodes/action_bar' %>
					
				</section>
			<%- end -%>
		<%- end -%>
		
	</div>
</div>
